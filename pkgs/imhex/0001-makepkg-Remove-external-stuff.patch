From 99e6e8e9c0c2138dac047f7e5c019bf89b151b68 Mon Sep 17 00:00:00 2001
From: KokaKiwi <kokakiwi+git@kokakiwi.net>
Date: Mon, 10 Jan 2022 15:47:10 +0100
Subject: [PATCH 1/2] makepkg: Remove external stuff

---
 CMakeLists.txt            |  4 ----
 cmake/build_helpers.cmake | 28 ----------------------------
 lib/external/libromfs     |  2 +-
 3 files changed, 1 insertion(+), 33 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 6b9f1f92..6832200c 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -11,7 +11,6 @@ include("${IMHEX_BASE_FOLDER}/cmake/build_helpers.cmake")
 
 # Make sure project is configured correctly
 setDefaultBuiltTypeIfUnset()
-detectBadClone()
 
 # List plugin names here. Project name must match folder name
 set(PLUGINS
@@ -36,6 +35,3 @@ add_subdirectory(tests EXCLUDE_FROM_ALL)
 
 # Configure packaging
 createPackage()
-
-# Download and install all current files from the ImHex-Patterns repo
-downloadImHexPatternsFiles()
\ No newline at end of file
diff --git a/cmake/build_helpers.cmake b/cmake/build_helpers.cmake
index b2f850ae..873525fb 100644
--- a/cmake/build_helpers.cmake
+++ b/cmake/build_helpers.cmake
@@ -270,31 +270,3 @@ macro(setDefaultBuiltTypeIfUnset)
         set_property(CACHE CMAKE_BUILD_TYPE PROPERTY STRINGS "Debug" "Release")
     endif()
 endmacro()
-
-macro(detectBadClone)
-    file (GLOB EXTERNAL_DIRS "lib/external/*")
-    foreach (EXTERNAL_DIR ${EXTERNAL_DIRS})
-        file(GLOB RESULT "${EXTERNAL_DIR}/*")
-        list(LENGTH RESULT ENTRY_COUNT)
-        if(ENTRY_COUNT LESS_EQUAL 1)
-            message(FATAL_ERROR "External dependency ${EXTERNAL_DIR} is empty!\nMake sure to correctly clone ImHex using the --recurse-submodules git option or initialize the submodules manually.")
-        endif()
-    endforeach ()
-endmacro()
-
-
-function(downloadImHexPatternsFiles)
-    FetchContent_Declare(
-        imhex_patterns
-        GIT_REPOSITORY https://github.com/WerWolv/ImHex-Patterns.git
-        GIT_TAG master
-    )
-
-    FetchContent_Populate(imhex_patterns)
-
-    set(PATTERNS_FOLDERS_TO_INSTALL constants encodings includes patterns yara magic)
-    foreach (FOLDER ${PATTERNS_FOLDERS_TO_INSTALL})
-        install(DIRECTORY "${imhex_patterns_SOURCE_DIR}/${FOLDER}" DESTINATION "./")
-    endforeach()
-
-endfunction()
\ No newline at end of file
diff --git a/lib/external/libromfs b/lib/external/libromfs
index 0842d22d..5d327344 160000
--- a/lib/external/libromfs
+++ b/lib/external/libromfs
@@ -1 +1 @@
-Subproject commit 0842d22deb13e036eb1fb15df368b6cad552abfe
+Subproject commit 5d3273443a47f4a2f295cc476b5266a84e836206
-- 
2.35.1

